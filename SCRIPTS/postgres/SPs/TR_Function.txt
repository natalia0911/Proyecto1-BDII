DROP FUNCTION TR_FUNCTION();
CREATE OR REPLACE FUNCTION TR_FUNCTION() returns TRIGGER
AS $$
DECLARE PRECIOMEJORFINAL DECIMAL;
BEGIN 
     SELECT S.PRECIOFINAL INTO PRECIOMEJORFINAL FROM SUBASTA S WHERE S.ID = NEW.SUBASTAID;
	 IF NEW.PRECIO>PRECIOMEJORFINAL THEN
        UPDATE SUBASTA 
        SET
            PRECIOFINAL = NEW.PRECIO
           ,IDGANADOR = NEW.COMPRADORID
        WHERE ID = NEW.SUBASTAID;
    END IF;
	RETURN TRIGGER;
END;
$$
LANGUAGE plpgsql